/*
 * TouchCarousel  v1.2
 * Copyright 2011, Dmitry Semenov, http://dimsemenov.com
 */
!function(t){function s(s,i){this.carouselRoot=t(s);var e=this;this._lockYAxis=!1,this._isAnimating=!1,this._downEvent="",this._moveEvent="",this._upEvent="",this._totalItemsWidth,this._itemWidths,this._startAccelerationX,this._accelerationX,this._latestDragX,this._startTime=0,this.settings=t.extend({},t.fn.touchCarousel.defaults,i),this._dragContainer=this.carouselRoot.find(".touchcarousel-container"),this._dragContainerStyle=this._dragContainer[0].style,this._itemsWrapper=this._dragContainer.wrap(t('<div class="touchcarousel-wrapper" />')).parent();var a=this._dragContainer.find(".touchcarousel-item");this.items=[],this.numItems=a.length;var o,r=function(t){var s=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:s[1]||"",version:s[2]||"0"}}(o=navigator.userAgent.toLowerCase()),n={};(r.browser&&(n[r.browser]=!0,n.version=r.version),n.chrome&&(n.webkit=!0),e._browser=n,this._decelerationAnim,this._successfullyDragged=!1,this._startMouseX=0,this._prevMouseX=0,this._moveDist=0,this._blockClickEvents=!1,this._wasBlocked=!1,this._useWebkitTransition=!1,"ontouchstart"in window)?(this.hasTouch=!0,this._downEvent="touchstart.rs",this._moveEvent="touchmove.rs",this._upEvent="touchend.rs",this._baseFriction=this.settings.baseTouchFriction):(this.hasTouch=!1,this._baseFriction=this.settings.baseMouseFriction,this.settings.dragUsingMouse?(this._downEvent="mousedown.rs",this._moveEvent="mousemove.rs",this._upEvent="mouseup.rs",this._grabCursor,this._grabbingCursor,(o=e._browser).msie||o.opera?this._grabCursor=this._grabbingCursor="move":o.mozilla&&(this._grabCursor="-moz-grab",this._grabbingCursor="-moz-grabbing"),this._setGrabCursor()):this._itemsWrapper.addClass("auto-cursor"));(this.hasTouch||this.settings.useWebkit3d)&&"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix&&(this._dragContainer.css({"-webkit-transform-origin":"0 0","-webkit-transform":"translateZ(0)"}),this._useWebkitTransition=!0),this._useWebkitTransition?(this._xProp="-webkit-transform",this._xPref="translate3d(",this._xSuf="px, 0, 0)"):(this._xProp="left",this._xPref="",this._xSuf="px"),this.hasTouch&&(this.settings.directionNavAutoHide=!1),this.settings.directionNav||(this.settings.loopItems?(this._arrowLeftBlocked=!0,this._arrowRightBlocked=!0):(this._arrowLeftBlocked=!1,this._arrowRightBlocked=!1),this.settings.loopItems=!0);var h,l,u,c=0;if(a.eq(this.numItems-1).addClass("last"),a.each((function(s){var i;(l=t(this),(h={}).item=l,h.index=s,h.posX=c,h.width=l.outerWidth(!0)||e.settings.itemFallbackWidth,c+=h.width,this.hasTouch)?l.find("a").each((function(){(i=t(this)).data("tc-href",i.attr("href")),i.data("tc-target",i.attr("target")),i.attr("href","#"),i.bind("click",(function(s){if(s.preventDefault(),e._successfullyDragged)return!1;var i=t(this).data("tc-href"),a=t(this).data("tc-target");a&&"_self"!==a.toLowerCase()?window.open(i):window.location.href=i}))})):l.find("a").bind("click.touchcarousel",(function(t){if(e._successfullyDragged)return t.preventDefault(),!1}));l.find(".non-draggable").bind(e._downEvent,(function(t){e._successfullyDragged=!1,t.stopImmediatePropagation()})),e.items.push(h)})),this._maxXPos=this._totalItemsWidth=c,this.settings.itemsPerMove>0?this._itemsPerMove=this.settings.itemsPerMove:this._itemsPerMove=1,this.settings.pagingNav){if(this.settings.snapToItems=!0,this._pagingEnabled=!0,this._numPages=Math.ceil(this.numItems/this._itemsPerMove),this._currPageId=0,this.settings.pagingNavControls){this._pagingNavContainer=t('<div class="tc-paging-container"><div class="tc-paging-centerer"><div class="tc-paging-centerer-inside"></div></div></div>');for(var d,_=this._pagingNavContainer.find(".tc-paging-centerer-inside"),g=1;g<=this._numPages;g++)d=t('<a class="tc-paging-item" href="#">'+g+"</a>").data("tc-id",g),g===this._currPageId+1&&d.addClass("current"),_.append(d);this._pagingItems=_.find(".tc-paging-item").click((function(s){s.preventDefault(),e.goTo((t(s.currentTarget).data("tc-id")-1)*e._itemsPerMove)})),this._itemsWrapper.after(this._pagingNavContainer)}}else this._pagingEnabled=!1;this._dragContainer.css({width:c}),this.settings.directionNav&&(this._itemsWrapper.after("<a href='#' class='arrow-holder left'><span class='arrow-icon left'></span></a> <a href='#' class='arrow-holder right'><span class='arrow-icon right'></span></a>"),this.arrowLeft=this.carouselRoot.find(".arrow-holder.left"),this.arrowRight=this.carouselRoot.find(".arrow-holder.right"),this.arrowLeft.length<1||this.arrowRight.length<1?this.settings.directionNav=!1:this.settings.directionNavAutoHide&&(this.arrowLeft.hide(),this.arrowRight.hide(),this.carouselRoot.one("mousemove.arrowshover",(function(){e.arrowLeft.fadeIn("fast"),e.arrowRight.fadeIn("fast")})),this.carouselRoot.hover((function(){e.arrowLeft.fadeIn("fast"),e.arrowRight.fadeIn("fast")}),(function(){e.arrowLeft.fadeOut("fast"),e.arrowRight.fadeOut("fast")}))),this._updateDirectionNav(0),this.settings.directionNav&&(this.arrowRight.click((function(t){t.preventDefault(),(e.settings.loopItems&&!e._blockClickEvents||!e._arrowRightBlocked)&&e.next()})),this.arrowLeft.click((function(t){t.preventDefault(),(e.settings.loopItems&&!e._blockClickEvents||!e._arrowLeftBlocked)&&e.prev()})))),this.carouselWidth,this._resizeEvent="resize",t(window).bind(this._resizeEvent,(function(){u&&clearTimeout(u),u=setTimeout((function(){e.updateCarouselSize(!1)}),100)})),this.settings.scrollbar?(this._scrollbarHolder=t("<div class='scrollbar-holder'><div class='scrollbar"+("light"===this.settings.scrollbarTheme.toLowerCase()?" light":" dark")+"'></div></div>"),this._scrollbarHolder.appendTo(this.carouselRoot),this.scrollbarJQ=this._scrollbarHolder.find(".scrollbar"),this._scrollbarHideTimeout="",this._scrollbarStyle=this.scrollbarJQ[0].style,this._scrollbarDist=0,this.settings.scrollbarAutoHide?(this._scrollbarVisible=!1,this.scrollbarJQ.css("opacity",0)):this._scrollbarVisible=!0):this.settings.scrollbarAutoHide=!1,this.updateCarouselSize(!0),this._itemsWrapper.bind(this._downEvent,(function(t){e._onDragStart(t)})),this.settings.autoplay&&this.settings.autoplayDelay>0?(this._isHovering=!1,this.autoplayTimer="",this.wasAutoplayRunning=!0,this.hasTouch||this.carouselRoot.hover((function(){e._isHovering=!0,e._stopAutoplay()}),(function(){e._isHovering=!1,e._resumeAutoplay()})),this.autoplay=!0,this._releaseAutoplay()):this.autoplay=!1,this.settings.keyboardNav&&t(document).bind("keydown.touchcarousel",(function(t){e._blockClickEvents||(37===t.keyCode?e.prev():39===t.keyCode&&e.next())})),this.carouselRoot.css("overflow","visible")}s.prototype={goTo:function(t,s){var i=this.items[t];if(i){!s&&this.autoplay&&this.settings.autoplayStopAtAction&&this.stopAutoplay(),this._updatePagingNav(t),this.endPos=this._getXPos();var e=-i.posX;e>0?e=0:e<this.carouselWidth-this._maxXPos&&(e=this.carouselWidth-this._maxXPos),this.animateTo(e,this.settings.transitionSpeed,"easeInOutSine")}},next:function(t){var s=this._getXPos(),i=this._getItemAtPos(s).index;if(this._pagingEnabled){var e=this._currPageId+1;i=e>this._numPages-1?this.settings.loopItems?0:(this._numPages-1)*this._itemsPerMove:e*this._itemsPerMove}else i+=this._itemsPerMove,this.settings.loopItems&&s<=this.carouselWidth-this._maxXPos&&(i=0),i>this.numItems-1&&(i=this.numItems-1);this.goTo(i,t)},prev:function(t){var s=this._getXPos(),i=this._getItemAtPos(s).index;if(this._pagingEnabled){var e=this._currPageId-1;i=e<0?this.settings.loopItems?(this._numPages-1)*this._itemsPerMove:0:e*this._itemsPerMove}else(i-=this._itemsPerMove)<0&&(i=this.settings.loopItems?s<0?0:this.numItems-1:0);this.goTo(i,t)},getCurrentId:function(){return this._getItemAtPos(this._getXPos()).index},setXPos:function(t,s){s?this._scrollbarStyle[this._xProp]=this._xPref+t+this._xSuf:this._dragContainerStyle[this._xProp]=this._xPref+t+this._xSuf},stopAutoplay:function(){this._stopAutoplay(),this.autoplay=!1,this.wasAutoplayRunning=!1},resumeAutoplay:function(){this.autoplay=!0,this.wasAutoplayRunning||this._resumeAutoplay()},updateItemSize:function(){var s=this,i=0;this._dragContainer.find(".touchcarousel-item").each((function(e){var a=t(this),o=s.items[e];o.width=a.outerWidth(!0)||s.settings.itemFallbackWidth,o.posX=i,i+=o.width})),this._totalItemsWidth=i,this._dragContainer.css({width:i})},updateCarouselSize:function(t){if(this.updateItemSize(),this.carouselWidth=this.carouselRoot.width(),this.settings.scrollToLast){var s=0;if(this._pagingEnabled){var i=this.numItems%this._itemsPerMove;if(i>0)for(var e=this.numItems-i;e<this.numItems;e++)s+=this.items[e].width;else s=this.carouselWidth}else s=this.items[this.numItems-1].width;this._maxXPos=this._totalItemsWidth+this.carouselWidth-s}else this._maxXPos=this._totalItemsWidth;if(this.settings.scrollbar){var a=Math.round(this._scrollbarHolder.width()/(this._maxXPos/this.carouselWidth));this.scrollbarJQ.css("width",a),this._scrollbarDist=this._scrollbarHolder.width()-a}if(!this.settings.scrollToLast){if(this.carouselWidth>=this._totalItemsWidth)return this._wasBlocked=!0,this.settings.loopItems||(this._arrowRightBlocked=!0,this.arrowRight.addClass("disabled"),this._arrowLeftBlocked=!0,this.arrowLeft.addClass("disabled")),void this.setXPos(0);this._wasBlocked&&(this._wasBlocked=!1,this._arrowRightBlocked=!1,this._arrowLeftBlocked=!1,this.arrowRight.removeClass("disabled"),this.arrowLeft.removeClass("disabled"))}if(!t){var o=this.endPos=this._getXPos();o>0?o=0:o<this.carouselWidth-this._maxXPos&&(o=this.carouselWidth-this._maxXPos),this.animateTo(o,300,"easeInOutSine")}},animateTo:function(s,i,e,a,o,r,n){null!==this.settings.onAnimStart&&this.settings.onAnimStart.call(this),this.autoplay&&this.autoplayTimer&&(this.wasAutoplayRunning=!0,this._stopAutoplay()),this._stopAnimation();var h=this,l=this.settings.scrollbar,u=h._xProp,c=h._xPref,d=h._xSuf,_={containerPos:this.endPos},g={containerPos:s},m={containerPos:o},p=(o=a?o:s,h._dragContainerStyle);if(h._isAnimating=!0,l){var f=this._scrollbarStyle,b=h._maxXPos-h.carouselWidth;this.settings.scrollbarAutoHide&&(this._scrollbarVisible||this._showScrollbar())}function v(){h._isAnimating=!1,h._releaseAutoplay(),h.settings.scrollbarAutoHide&&h._hideScrollbar(),null!==h.settings.onAnimComplete&&h.settings.onAnimComplete.call(h)}this._updateDirectionNav(o),this._decelerationAnim=t(_).animate(g,{duration:i,easing:e,step:function(){l&&(f[u]=c+Math.round(h._scrollbarDist*(-this.containerPos/b))+d),p[u]=c+Math.round(this.containerPos)+d},complete:function(){a?h._decelerationAnim=t(g).animate(m,{duration:r,easing:n,step:function(){l&&(f[u]=c+Math.round(h._scrollbarDist*(-this.containerPos/b))+d),p[u]=c+Math.round(this.containerPos)+d},complete:function(){l&&(f[u]=c+Math.round(h._scrollbarDist*(-m.containerPos/b))+d),p[u]=c+Math.round(m.containerPos)+d,v()}}):(l&&(f[u]=c+Math.round(h._scrollbarDist*(-g.containerPos/b))+d),p[u]=c+Math.round(g.containerPos)+d,v())}})},destroy:function(){this.stopAutoplay(),this._itemsWrapper.unbind(this._downEvent),t(document).unbind(this._moveEvent).unbind(this._upEvent),t(window).unbind(this._resizeEvent),this.settings.keyboardNav&&t(document).unbind("keydown.touchcarousel"),this.carouselRoot.remove()},_updatePagingNav:function(t){if(this._pagingEnabled){var s=this._getPageIdFromItemId(t);this._currPageId=s,this.settings.pagingNavControls&&(this._pagingItems.removeClass("current"),this._pagingItems.eq(s).addClass("current"))}},_getPageIdFromItemId:function(t){for(var s=this._itemsPerMove,i=0;i<this._numPages;i++)if(t>=i*s&&t<i*s+s)return i;return t<0?0:t>=this._numPages&&this._numPages-1},_enableArrows:function(){this.settings.loopItems||(this._arrowLeftBlocked?(this._arrowLeftBlocked=!1,this.arrowLeft.removeClass("disabled")):this._arrowRightBlocked&&(this._arrowRightBlocked=!1,this.arrowRight.removeClass("disabled")))},_disableLeftArrow:function(){this._arrowLeftBlocked||this.settings.loopItems||(this._arrowLeftBlocked=!0,this.arrowLeft.addClass("disabled"),this._arrowRightBlocked&&(this._arrowRightBlocked=!1,this.arrowRight.removeClass("disabled")))},_disableRightArrow:function(){this._arrowRightBlocked||this.settings.loopItems||(this._arrowRightBlocked=!0,this.arrowRight.addClass("disabled"),this._arrowLeftBlocked&&(this._arrowLeftBlocked=!1,this.arrowLeft.removeClass("disabled")))},_getItemAtPos:function(t){var s;t=-t;for(var i=0;i<this.numItems;i++)if(t>=(s=this.items[i]).posX&&t<s.posX+s.width)return s;return-1},_releaseAutoplay:function(){this.autoplay&&this.wasAutoplayRunning&&(this._isHovering||this._resumeAutoplay(),this.wasAutoplayRunning=!1)},_hideScrollbar:function(){var t=this;this._scrollbarVisible=!1,this._scrollbarHideTimeout&&clearTimeout(this._scrollbarHideTimeout),this._scrollbarHideTimeout=setTimeout((function(){t.scrollbarJQ.animate({opacity:0},150,"linear")}),450)},_showScrollbar:function(){this._scrollbarVisible=!0,this._scrollbarHideTimeout&&clearTimeout(this._scrollbarHideTimeout),this.scrollbarJQ.stop().animate({opacity:1},150,"linear")},_stopAnimation:function(){this._decelerationAnim&&this._decelerationAnim.stop()},_resumeAutoplay:function(){if(this.autoplay){var t=this;this.autoplayTimer||(this.autoplayTimer=setInterval((function(){t._isDragging||t._isAnimating||t.next(!0)}),this.settings.autoplayDelay))}},_stopAutoplay:function(){this.autoplayTimer&&(clearInterval(this.autoplayTimer),this.autoplayTimer="")},_getXPos:function(t){var s=t?this.scrollbarJQ:this._dragContainer;if(this._useWebkitTransition){var i=s.css("-webkit-transform").replace(/^matrix\(/i,"").split(/, |\)$/g);return parseInt(i[4],10)}return Math.round(s.position().left)},_onDragStart:function(s){if(!this._isDragging){var i;if(this.autoplay&&this.settings.autoplayStopAtAction&&this.stopAutoplay(),this._stopAnimation(),this.settings.scrollbarAutoHide&&this._showScrollbar(),this.hasTouch){this._lockYAxis=!1;var e=s.originalEvent.touches;if(!(e&&e.length>0))return!1;i=e[0]}else i=s,s.preventDefault();this._setGrabbingCursor(),this._isDragging=!0;var a=this;this._useWebkitTransition&&a._dragContainer.css({"-webkit-transition-duration":"0","-webkit-transition-property":"none"}),t(document).bind(this._moveEvent,(function(t){a._onDragMove(t)})),t(document).bind(this._upEvent,(function(t){a._onDragRelease(t)})),this._startPos=this._getXPos(),this._accelerationX=i.clientX,this._successfullyDragged=!1,this._startTime=s.timeStamp||(new Date).getTime(),this._moveDist=0,this._prevMouseX=this._startMouseX=i.clientX,this._startMouseY=i.clientY}},_onDragMove:function(t){var s,i=t.timeStamp||(new Date).getTime();if(this.hasTouch){if(this._lockYAxis)return!1;var e=t.originalEvent.touches;if(e.length>1)return!1;if(s=e[0],Math.abs(s.clientY-this._startMouseY)>Math.abs(s.clientX-this._startMouseX)+3)return this.settings.lockAxis&&(this._lockYAxis=!0),!1;t.preventDefault()}else s=t,t.preventDefault();this._latestDragX=s.clientX,this._lastDragPosition=this._currentDragPosition;var a=s.clientX-this._prevMouseX;if(this._lastDragPosition!=a&&(this._currentDragPosition=a),0!=a){var o=this._startPos+this._moveDist;o>=0?(a/=4,this._disableLeftArrow()):o<=this.carouselWidth-this._maxXPos?(this._disableRightArrow(),a/=4):this._enableArrows(),this._moveDist+=a,this.setXPos(o),this.settings.scrollbar&&this.setXPos(this._scrollbarDist*(-o/(this._maxXPos-this.carouselWidth)),!0)}return this._prevMouseX=s.clientX,i-this._startTime>350&&(this._startTime=i,this._accelerationX=s.clientX),null!==this.settings.onDragStart&&this.settings.onDragStart.call(this),!1},_onDragRelease:function(s){if(this._isDragging){var i=this;if(this._isDragging=!1,this._setGrabCursor(),this.endPos=this._getXPos(),this.isdrag=!1,t(document).unbind(this._moveEvent).unbind(this._upEvent),this.endPos==this._startPos)return this._successfullyDragged=!1,void(this.settings.scrollbarAutoHide&&this._hideScrollbar());this._successfullyDragged=!0;var e=this._latestDragX-this._accelerationX,a=Math.max(40,(s.timeStamp||(new Date).getTime())-this._startTime),o=.5,r=Math.abs(e)/a;function n(t){return t>0?t=0:t<i.carouselWidth-i._maxXPos&&(t=i.carouselWidth-i._maxXPos),t}if(this.settings.snapToItems){this.autoplay&&this.settings.autoplayStopAtAction&&this.stopAutoplay();var h=Boolean(this._startMouseX-this._prevMouseX>0),l=n(this._getXPos()),u=this._getItemAtPos(l).index;if(this._pagingEnabled)h&&(l=Math.max(l-this.carouselWidth-1,1-i._maxXPos),void 0===(u=this._getItemAtPos(l).index)&&(u=this.numItems-1)),u=this._getPageIdFromItemId(u)*this._itemsPerMove;else u+=h?this._itemsPerMove:1-this._itemsPerMove;u=h?Math.min(u,this.numItems-1):Math.max(u,0);var c=this.items[u];if(this._updatePagingNav(u),c){l=n(-c.posX);var d=Math.abs(this.endPos-l),_=Math.max(1.08*d/r,150),g=Boolean(_<180),m=.08*d;h&&(m*=-1),this.animateTo(g?l+m:l,Math.min(_,400),"easeOutSine",g,l,300,"easeOutCubic")}}else{var p=0;r<=2?(o=3.5*this._baseFriction,p=0):r>2&&r<=3?(o=4*this._baseFriction,p=200):r>3&&(p=300,r>4&&(r=4,p=400,o=6*this._baseFriction),o=5*this._baseFriction);var f=r*r*2/(2*o);f*=e<0?-1:1;var b=2*r/o+p;this.endPos+f>0?this.endPos>0?this.animateTo(0,800,"easeOutCubic"):this.animateTo(this.carouselWidth/10*((p+200)/1e3),1.1*Math.abs(this.endPos)/r,"easeOutSine",!0,0,400,"easeOutCubic"):this.endPos+f<this.carouselWidth-this._maxXPos?this.endPos<this.carouselWidth-this._maxXPos?this.animateTo(this.carouselWidth-this._maxXPos,800,"easeOutCubic"):this.animateTo(this.carouselWidth-this._maxXPos-this.carouselWidth/10*((p+200)/1e3),1.1*Math.abs(this.carouselWidth-this._maxXPos-this.endPos)/r,"easeOutSine",!0,this.carouselWidth-this._maxXPos,400,"easeOutCubic"):this.animateTo(this.endPos+f,b,"easeOutCubic")}null!==this.settings.onDragRelease&&this.settings.onDragRelease.call(this)}return!1},_updateDirectionNav:function(t){void 0===t&&(t=this._getXPos()),this.settings.loopItems||(t>=0?this._disableLeftArrow():t<=this.carouselWidth-this._maxXPos?this._disableRightArrow():this._enableArrows())},_setGrabCursor:function(){this._grabCursor?this._itemsWrapper.css("cursor",this._grabCursor):(this._itemsWrapper.removeClass("grabbing-cursor"),this._itemsWrapper.addClass("grab-cursor"))},_setGrabbingCursor:function(){this._grabbingCursor?this._itemsWrapper.css("cursor",this._grabbingCursor):(this._itemsWrapper.removeClass("grab-cursor"),this._itemsWrapper.addClass("grabbing-cursor"))}},t.fn.touchCarousel=function(i){return this.each((function(){var e=new s(t(this),i);t(this).data("touchCarousel",e)}))},t.fn.touchCarousel.defaults={itemsPerMove:1,snapToItems:!1,pagingNav:!1,pagingNavControls:!0,autoplay:!1,autoplayDelay:3e3,autoplayStopAtAction:!0,scrollbar:!0,scrollbarAutoHide:!1,scrollbarTheme:"dark",transitionSpeed:600,directionNav:!0,directionNavAutoHide:!1,loopItems:!1,keyboardNav:!1,dragUsingMouse:!0,scrollToLast:!1,itemFallbackWidth:500,baseMouseFriction:.0012,baseTouchFriction:8e-4,lockAxis:!0,useWebkit3d:!1,onAnimStart:null,onAnimComplete:null,onDragStart:null,onDragRelease:null},t.fn.touchCarousel.settings={},t.extend(jQuery.easing,{easeInOutSine:function(t,s,i,e,a){return-e/2*(Math.cos(Math.PI*s/a)-1)+i},easeOutSine:function(t,s,i,e,a){return e*Math.sin(s/a*(Math.PI/2))+i},easeOutCubic:function(t,s,i,e,a){return e*((s=s/a-1)*s*s+1)+i}})}(jQuery);